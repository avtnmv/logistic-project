{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { getGlobalTestDB } from '../data/testData';\nexport const useCurrentUser = () => {\n  _s();\n  const [currentUser, setCurrentUser] = useState(null);\n  useEffect(() => {\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥ –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏\n    const clearedAll = localStorage.getItem('CLEARED_ALL_DATA');\n    if (clearedAll === 'true') {\n      console.log('üßπ –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ–ª–∞–≥ –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ - –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');\n      setCurrentUser(null);\n      return;\n    }\n\n    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ localStorage\n    const storedUser = localStorage.getItem('currentUser');\n    console.log('useCurrentUser: storedUser =', storedUser);\n    if (storedUser) {\n      try {\n        const userData = JSON.parse(storedUser);\n        console.log('useCurrentUser: parsed userData =', userData);\n\n        // –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç ID, –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –µ–≥–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö\n        if (!userData.id) {\n          const testDB = getGlobalTestDB();\n          const dbUser = testDB.users[userData.phone];\n          if (dbUser && dbUser.id) {\n            // –ò—Å–ø–æ–ª—å–∑—É–µ–º ID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö\n            const updatedUserData = {\n              ...userData,\n              id: dbUser.id\n            };\n\n            // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage\n            localStorage.setItem('currentUser', JSON.stringify(updatedUserData));\n            setCurrentUser(updatedUserData);\n          } else {\n            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π ID —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –≤ –±–∞–∑–µ\n            const updatedUserData = {\n              ...userData,\n              id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\n            };\n\n            // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage\n            localStorage.setItem('currentUser', JSON.stringify(updatedUserData));\n            setCurrentUser(updatedUserData);\n          }\n        } else {\n          setCurrentUser(userData);\n        }\n      } catch (error) {\n        console.warn('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);\n      }\n    } else {\n      console.log('useCurrentUser: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage');\n    }\n  }, []);\n  return currentUser;\n};\n_s(useCurrentUser, \"Y5F2pQQk2LZA5WRO2+bvRm5iRuo=\");","map":{"version":3,"names":["useState","useEffect","getGlobalTestDB","useCurrentUser","_s","currentUser","setCurrentUser","clearedAll","localStorage","getItem","console","log","storedUser","userData","JSON","parse","id","testDB","dbUser","users","phone","updatedUserData","setItem","stringify","Date","now","Math","random","toString","substr","error","warn"],"sources":["/Users/avtnmv/Documents/Front-End/logistics-project-react¬†‚Äî –∫–æ–ø–∏—è/src/hooks/useCurrentUser.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { getGlobalTestDB } from '../data/testData';\n\nexport interface CurrentUser {\n  id: string;\n  phone: string;\n  firstName?: string;\n  lastName?: string;\n  email?: string;\n}\n\nexport const useCurrentUser = (): CurrentUser | null => {\n  const [currentUser, setCurrentUser] = useState<CurrentUser | null>(null);\n\n  useEffect(() => {\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥ –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏\n    const clearedAll = localStorage.getItem('CLEARED_ALL_DATA');\n    if (clearedAll === 'true') {\n      console.log('üßπ –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ–ª–∞–≥ –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ - –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');\n      setCurrentUser(null);\n      return;\n    }\n    \n    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ localStorage\n    const storedUser = localStorage.getItem('currentUser');\n    console.log('useCurrentUser: storedUser =', storedUser);\n    \n    if (storedUser) {\n      try {\n        const userData = JSON.parse(storedUser);\n        console.log('useCurrentUser: parsed userData =', userData);\n        \n        // –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç ID, –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –µ–≥–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö\n        if (!userData.id) {\n          const testDB = getGlobalTestDB();\n          const dbUser = testDB.users[userData.phone];\n          \n          if (dbUser && dbUser.id) {\n            // –ò—Å–ø–æ–ª—å–∑—É–µ–º ID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö\n            const updatedUserData = {\n              ...userData,\n              id: dbUser.id\n            };\n            \n            // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage\n            localStorage.setItem('currentUser', JSON.stringify(updatedUserData));\n            setCurrentUser(updatedUserData);\n          } else {\n            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π ID —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –≤ –±–∞–∑–µ\n            const updatedUserData = {\n              ...userData,\n              id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\n            };\n            \n            // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage\n            localStorage.setItem('currentUser', JSON.stringify(updatedUserData));\n            setCurrentUser(updatedUserData);\n          }\n        } else {\n          setCurrentUser(userData);\n        }\n      } catch (error) {\n        console.warn('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);\n      }\n    } else {\n      console.log('useCurrentUser: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage');\n    }\n  }, []);\n\n  return currentUser;\n};\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,eAAe,QAAQ,kBAAkB;AAUlD,OAAO,MAAMC,cAAc,GAAGA,CAAA,KAA0B;EAAAC,EAAA;EACtD,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGN,QAAQ,CAAqB,IAAI,CAAC;EAExEC,SAAS,CAAC,MAAM;IACd;IACA,MAAMM,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAC;IAC3D,IAAIF,UAAU,KAAK,MAAM,EAAE;MACzBG,OAAO,CAACC,GAAG,CAAC,8DAA8D,CAAC;MAC3EL,cAAc,CAAC,IAAI,CAAC;MACpB;IACF;;IAEA;IACA,MAAMM,UAAU,GAAGJ,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;IACtDC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEC,UAAU,CAAC;IAEvD,IAAIA,UAAU,EAAE;MACd,IAAI;QACF,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACH,UAAU,CAAC;QACvCF,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAEE,QAAQ,CAAC;;QAE1D;QACA,IAAI,CAACA,QAAQ,CAACG,EAAE,EAAE;UAChB,MAAMC,MAAM,GAAGf,eAAe,CAAC,CAAC;UAChC,MAAMgB,MAAM,GAAGD,MAAM,CAACE,KAAK,CAACN,QAAQ,CAACO,KAAK,CAAC;UAE3C,IAAIF,MAAM,IAAIA,MAAM,CAACF,EAAE,EAAE;YACvB;YACA,MAAMK,eAAe,GAAG;cACtB,GAAGR,QAAQ;cACXG,EAAE,EAAEE,MAAM,CAACF;YACb,CAAC;;YAED;YACAR,YAAY,CAACc,OAAO,CAAC,aAAa,EAAER,IAAI,CAACS,SAAS,CAACF,eAAe,CAAC,CAAC;YACpEf,cAAc,CAACe,eAAe,CAAC;UACjC,CAAC,MAAM;YACL;YACA,MAAMA,eAAe,GAAG;cACtB,GAAGR,QAAQ;cACXG,EAAE,EAAE,QAAQQ,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;YACnE,CAAC;;YAED;YACArB,YAAY,CAACc,OAAO,CAAC,aAAa,EAAER,IAAI,CAACS,SAAS,CAACF,eAAe,CAAC,CAAC;YACpEf,cAAc,CAACe,eAAe,CAAC;UACjC;QACF,CAAC,MAAM;UACLf,cAAc,CAACO,QAAQ,CAAC;QAC1B;MACF,CAAC,CAAC,OAAOiB,KAAK,EAAE;QACdpB,OAAO,CAACqB,IAAI,CAAC,sCAAsC,EAAED,KAAK,CAAC;MAC7D;IACF,CAAC,MAAM;MACLpB,OAAO,CAACC,GAAG,CAAC,uDAAuD,CAAC;IACtE;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,OAAON,WAAW;AACpB,CAAC;AAACD,EAAA,CA3DWD,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}