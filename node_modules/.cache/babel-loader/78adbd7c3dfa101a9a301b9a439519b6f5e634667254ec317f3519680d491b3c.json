{"ast":null,"code":"var _VerificationService;\n// Интерфейс для результата верификации\n\n// Интерфейс для параметров верификации\n\n/**\n * Сервис для отправки SMS кодов верификации\n */\nexport class VerificationService {\n  // 10 минут\n\n  constructor() {\n    this.generatedCodes = new Map();\n    this.CODE_EXPIRY_TIME = 10 * 60 * 1000;\n  }\n\n  /**\n   * Получает единственный экземпляр сервиса (Singleton)\n   */\n  static getInstance() {\n    if (!VerificationService.instance) {\n      VerificationService.instance = new VerificationService();\n    }\n    return VerificationService.instance;\n  }\n\n  /**\n   * Генерирует случайный 4-значный код\n   */\n  generateVerificationCode() {\n    return Math.floor(1000 + Math.random() * 9000).toString();\n  }\n\n  /**\n   * Отправляет код верификации на телефон\n   */\n  async sendCode(params) {\n    try {\n      // Генерируем код\n      const code = this.generateVerificationCode();\n\n      // Сохраняем код с временной меткой\n      this.generatedCodes.set(params.phone, {\n        code,\n        timestamp: Date.now()\n      });\n\n      // Отправляем код на SMS\n      return await this.sendSMSCode(params.phone, code, params.userName);\n    } catch (error) {\n      console.error('Ошибка отправки кода:', error);\n      return {\n        success: false,\n        message: 'Не удалось отправить код. Попробуйте еще раз.'\n      };\n    }\n  }\n\n  /**\n   * Отправляет код на SMS (имитация для бесплатного использования)\n   */\n  async sendSMSCode(phone, code, userName) {\n    // Имитируем отправку SMS\n    // В реальном проекте здесь будет интеграция с SMS сервисом\n\n    // Для демонстрации показываем код в консоли\n    console.log(code);\n\n    // Имитируем задержку сети\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    return {\n      success: true,\n      message: `Код подтверждения отправлен на ${phone}`,\n      code: code // Возвращаем код для тестирования\n    };\n  }\n\n  /**\n   * Проверяет код верификации\n   */\n  verifyCode(phone, inputCode) {\n    const storedData = this.generatedCodes.get(phone);\n    if (!storedData) {\n      return {\n        success: false,\n        message: 'Код не найден. Запросите новый код.'\n      };\n    }\n\n    // Проверяем срок действия кода\n    if (Date.now() - storedData.timestamp > this.CODE_EXPIRY_TIME) {\n      this.generatedCodes.delete(phone);\n      return {\n        success: false,\n        message: 'Код истек. Запросите новый код.'\n      };\n    }\n\n    // Проверяем правильность кода\n    if (storedData.code === inputCode) {\n      // Удаляем использованный код\n      this.generatedCodes.delete(phone);\n      return {\n        success: true,\n        message: 'Код подтвержден успешно!'\n      };\n    } else {\n      return {\n        success: false,\n        message: 'Неверный код. Попробуйте еще раз.'\n      };\n    }\n  }\n\n  /**\n   * Проверяет, есть ли активный код для телефона\n   */\n  hasActiveCode(phone) {\n    const storedData = this.generatedCodes.get(phone);\n    if (!storedData) return false;\n    return Date.now() - storedData.timestamp <= this.CODE_EXPIRY_TIME;\n  }\n\n  /**\n   * Очищает все истекшие коды\n   */\n  cleanupExpiredCodes() {\n    const now = Date.now();\n    this.generatedCodes.forEach((data, phone) => {\n      if (now - data.timestamp > this.CODE_EXPIRY_TIME) {\n        this.generatedCodes.delete(phone);\n      }\n    });\n  }\n\n  /**\n   * Получает количество активных кодов\n   */\n  getActiveCodesCount() {\n    this.cleanupExpiredCodes();\n    return this.generatedCodes.size;\n  }\n\n  /**\n   * Получает код для тестирования (только для разработки)\n   */\n  getCodeForTesting(phone) {\n    const storedData = this.generatedCodes.get(phone);\n    if (storedData && Date.now() - storedData.timestamp <= this.CODE_EXPIRY_TIME) {\n      return storedData.code;\n    }\n    return null;\n  }\n}\n\n// Экспортируем экземпляр сервиса\n_VerificationService = VerificationService;\nVerificationService.instance = void 0;\nexport const verificationService = VerificationService.getInstance();","map":{"version":3,"names":["VerificationService","constructor","generatedCodes","Map","CODE_EXPIRY_TIME","getInstance","instance","generateVerificationCode","Math","floor","random","toString","sendCode","params","code","set","phone","timestamp","Date","now","sendSMSCode","userName","error","console","success","message","log","Promise","resolve","setTimeout","verifyCode","inputCode","storedData","get","delete","hasActiveCode","cleanupExpiredCodes","forEach","data","getActiveCodesCount","size","getCodeForTesting","_VerificationService","verificationService"],"sources":["/Users/avtnmv/Documents/Front-End/logistics-project-react/src/services/verificationService.ts"],"sourcesContent":["// Интерфейс для результата верификации\nexport interface VerificationResult {\n  success: boolean;\n  message: string;\n  code?: string;\n}\n\n// Интерфейс для параметров верификации\nexport interface VerificationParams {\n  phone: string;\n  userName?: string;\n}\n\n/**\n * Сервис для отправки SMS кодов верификации\n */\nexport class VerificationService {\n  private static instance: VerificationService;\n  private generatedCodes: Map<string, { code: string; timestamp: number }> = new Map();\n  private readonly CODE_EXPIRY_TIME = 10 * 60 * 1000; // 10 минут\n\n  private constructor() {}\n\n  /**\n   * Получает единственный экземпляр сервиса (Singleton)\n   */\n  public static getInstance(): VerificationService {\n    if (!VerificationService.instance) {\n      VerificationService.instance = new VerificationService();\n    }\n    return VerificationService.instance;\n  }\n\n  /**\n   * Генерирует случайный 4-значный код\n   */\n  private generateVerificationCode(): string {\n    return Math.floor(1000 + Math.random() * 9000).toString();\n  }\n\n  /**\n   * Отправляет код верификации на телефон\n   */\n  public async sendCode(params: VerificationParams): Promise<VerificationResult> {\n    try {\n      // Генерируем код\n      const code = this.generateVerificationCode();\n      \n      // Сохраняем код с временной меткой\n      this.generatedCodes.set(params.phone, {\n        code,\n        timestamp: Date.now()\n      });\n\n      // Отправляем код на SMS\n      return await this.sendSMSCode(params.phone, code, params.userName);\n\n    } catch (error) {\n      console.error('Ошибка отправки кода:', error);\n      return {\n        success: false,\n        message: 'Не удалось отправить код. Попробуйте еще раз.'\n      };\n    }\n  }\n\n  /**\n   * Отправляет код на SMS (имитация для бесплатного использования)\n   */\n  private async sendSMSCode(\n    phone: string, \n    code: string, \n    userName?: string\n  ): Promise<VerificationResult> {\n    // Имитируем отправку SMS\n    // В реальном проекте здесь будет интеграция с SMS сервисом\n    \n    // Для демонстрации показываем код в консоли\n    console.log(code);\n    \n    // Имитируем задержку сети\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    return {\n      success: true,\n      message: `Код подтверждения отправлен на ${phone}`,\n      code: code // Возвращаем код для тестирования\n    };\n  }\n\n  /**\n   * Проверяет код верификации\n   */\n  public verifyCode(phone: string, inputCode: string): VerificationResult {\n    const storedData = this.generatedCodes.get(phone);\n    \n    if (!storedData) {\n      return {\n        success: false,\n        message: 'Код не найден. Запросите новый код.'\n      };\n    }\n\n    // Проверяем срок действия кода\n    if (Date.now() - storedData.timestamp > this.CODE_EXPIRY_TIME) {\n      this.generatedCodes.delete(phone);\n      return {\n        success: false,\n        message: 'Код истек. Запросите новый код.'\n      };\n    }\n\n    // Проверяем правильность кода\n    if (storedData.code === inputCode) {\n      // Удаляем использованный код\n      this.generatedCodes.delete(phone);\n      return {\n        success: true,\n        message: 'Код подтвержден успешно!'\n      };\n    } else {\n      return {\n        success: false,\n        message: 'Неверный код. Попробуйте еще раз.'\n      };\n    }\n  }\n\n  /**\n   * Проверяет, есть ли активный код для телефона\n   */\n  public hasActiveCode(phone: string): boolean {\n    const storedData = this.generatedCodes.get(phone);\n    if (!storedData) return false;\n    \n    return Date.now() - storedData.timestamp <= this.CODE_EXPIRY_TIME;\n  }\n\n  /**\n   * Очищает все истекшие коды\n   */\n  public cleanupExpiredCodes(): void {\n    const now = Date.now();\n    this.generatedCodes.forEach((data, phone) => {\n      if (now - data.timestamp > this.CODE_EXPIRY_TIME) {\n        this.generatedCodes.delete(phone);\n      }\n    });\n  }\n\n  /**\n   * Получает количество активных кодов\n   */\n  public getActiveCodesCount(): number {\n    this.cleanupExpiredCodes();\n    return this.generatedCodes.size;\n  }\n\n  /**\n   * Получает код для тестирования (только для разработки)\n   */\n  public getCodeForTesting(phone: string): string | null {\n    const storedData = this.generatedCodes.get(phone);\n    if (storedData && Date.now() - storedData.timestamp <= this.CODE_EXPIRY_TIME) {\n      return storedData.code;\n    }\n    return null;\n  }\n}\n\n// Экспортируем экземпляр сервиса\nexport const verificationService = VerificationService.getInstance();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}