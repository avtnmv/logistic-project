{"ast":null,"code":"var _VerificationService;// Интерфейс для результата верификации\n// Интерфейс для параметров верификации\n/**\n * Сервис для отправки SMS кодов верификации\n */export class VerificationService{// 10 минут\nconstructor(){this.generatedCodes=new Map();this.CODE_EXPIRY_TIME=10*60*1000;}/**\n   * Получает единственный экземпляр сервиса (Singleton)\n   */static getInstance(){if(!VerificationService.instance){VerificationService.instance=new VerificationService();}return VerificationService.instance;}/**\n   * Генерирует случайный 4-значный код\n   */generateVerificationCode(){return Math.floor(1000+Math.random()*9000).toString();}/**\n   * Отправляет код верификации на телефон\n   */async sendCode(params){try{// Генерируем код\nconst code=this.generateVerificationCode();// Сохраняем код с временной меткой\nthis.generatedCodes.set(params.phone,{code,timestamp:Date.now()});// Отправляем код на SMS\nreturn await this.sendSMSCode(params.phone,code,params.userName);}catch(error){console.error('Ошибка отправки кода:',error);return{success:false,message:'Не удалось отправить код. Попробуйте еще раз.'};}}/**\n   * Отправляет код на SMS (имитация для бесплатного использования)\n   */async sendSMSCode(phone,code,userName){// Имитируем отправку SMS\n// В реальном проекте здесь будет интеграция с SMS сервисом\n// Для демонстрации показываем код в консоли\nconsole.log(code);// Имитируем задержку сети\nawait new Promise(resolve=>setTimeout(resolve,1000));return{success:true,message:\"\\u041A\\u043E\\u0434 \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D \\u043D\\u0430 \".concat(phone),code:code// Возвращаем код для тестирования\n};}/**\n   * Проверяет код верификации\n   */verifyCode(phone,inputCode){const storedData=this.generatedCodes.get(phone);if(!storedData){return{success:false,message:'Код не найден. Запросите новый код.'};}// Проверяем срок действия кода\nif(Date.now()-storedData.timestamp>this.CODE_EXPIRY_TIME){this.generatedCodes.delete(phone);return{success:false,message:'Код истек. Запросите новый код.'};}// Проверяем правильность кода\nif(storedData.code===inputCode){// Удаляем использованный код\nthis.generatedCodes.delete(phone);return{success:true,message:'Код подтвержден успешно!'};}else{return{success:false,message:'Неверный код. Попробуйте еще раз.'};}}/**\n   * Проверяет, есть ли активный код для телефона\n   */hasActiveCode(phone){const storedData=this.generatedCodes.get(phone);if(!storedData)return false;return Date.now()-storedData.timestamp<=this.CODE_EXPIRY_TIME;}/**\n   * Очищает все истекшие коды\n   */cleanupExpiredCodes(){const now=Date.now();this.generatedCodes.forEach((data,phone)=>{if(now-data.timestamp>this.CODE_EXPIRY_TIME){this.generatedCodes.delete(phone);}});}/**\n   * Получает количество активных кодов\n   */getActiveCodesCount(){this.cleanupExpiredCodes();return this.generatedCodes.size;}/**\n   * Получает код для тестирования (только для разработки)\n   */getCodeForTesting(phone){const storedData=this.generatedCodes.get(phone);if(storedData&&Date.now()-storedData.timestamp<=this.CODE_EXPIRY_TIME){return storedData.code;}return null;}}// Экспортируем экземпляр сервиса\n_VerificationService=VerificationService;VerificationService.instance=void 0;export const verificationService=VerificationService.getInstance();","map":{"version":3,"names":["VerificationService","constructor","generatedCodes","Map","CODE_EXPIRY_TIME","getInstance","instance","generateVerificationCode","Math","floor","random","toString","sendCode","params","code","set","phone","timestamp","Date","now","sendSMSCode","userName","error","console","success","message","log","Promise","resolve","setTimeout","concat","verifyCode","inputCode","storedData","get","delete","hasActiveCode","cleanupExpiredCodes","forEach","data","getActiveCodesCount","size","getCodeForTesting","_VerificationService","verificationService"],"sources":["/Users/avtnmv/Documents/Front-End/logistics-project-react/src/services/verificationService.ts"],"sourcesContent":["// Интерфейс для результата верификации\nexport interface VerificationResult {\n  success: boolean;\n  message: string;\n  code?: string;\n}\n\n// Интерфейс для параметров верификации\nexport interface VerificationParams {\n  phone: string;\n  userName?: string;\n}\n\n/**\n * Сервис для отправки SMS кодов верификации\n */\nexport class VerificationService {\n  private static instance: VerificationService;\n  private generatedCodes: Map<string, { code: string; timestamp: number }> = new Map();\n  private readonly CODE_EXPIRY_TIME = 10 * 60 * 1000; // 10 минут\n\n  private constructor() {}\n\n  /**\n   * Получает единственный экземпляр сервиса (Singleton)\n   */\n  public static getInstance(): VerificationService {\n    if (!VerificationService.instance) {\n      VerificationService.instance = new VerificationService();\n    }\n    return VerificationService.instance;\n  }\n\n  /**\n   * Генерирует случайный 4-значный код\n   */\n  private generateVerificationCode(): string {\n    return Math.floor(1000 + Math.random() * 9000).toString();\n  }\n\n  /**\n   * Отправляет код верификации на телефон\n   */\n  public async sendCode(params: VerificationParams): Promise<VerificationResult> {\n    try {\n      // Генерируем код\n      const code = this.generateVerificationCode();\n      \n      // Сохраняем код с временной меткой\n      this.generatedCodes.set(params.phone, {\n        code,\n        timestamp: Date.now()\n      });\n\n      // Отправляем код на SMS\n      return await this.sendSMSCode(params.phone, code, params.userName);\n\n    } catch (error) {\n      console.error('Ошибка отправки кода:', error);\n      return {\n        success: false,\n        message: 'Не удалось отправить код. Попробуйте еще раз.'\n      };\n    }\n  }\n\n  /**\n   * Отправляет код на SMS (имитация для бесплатного использования)\n   */\n  private async sendSMSCode(\n    phone: string, \n    code: string, \n    userName?: string\n  ): Promise<VerificationResult> {\n    // Имитируем отправку SMS\n    // В реальном проекте здесь будет интеграция с SMS сервисом\n    \n    // Для демонстрации показываем код в консоли\n    console.log(code);\n    \n    // Имитируем задержку сети\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    return {\n      success: true,\n      message: `Код подтверждения отправлен на ${phone}`,\n      code: code // Возвращаем код для тестирования\n    };\n  }\n\n  /**\n   * Проверяет код верификации\n   */\n  public verifyCode(phone: string, inputCode: string): VerificationResult {\n    const storedData = this.generatedCodes.get(phone);\n    \n    if (!storedData) {\n      return {\n        success: false,\n        message: 'Код не найден. Запросите новый код.'\n      };\n    }\n\n    // Проверяем срок действия кода\n    if (Date.now() - storedData.timestamp > this.CODE_EXPIRY_TIME) {\n      this.generatedCodes.delete(phone);\n      return {\n        success: false,\n        message: 'Код истек. Запросите новый код.'\n      };\n    }\n\n    // Проверяем правильность кода\n    if (storedData.code === inputCode) {\n      // Удаляем использованный код\n      this.generatedCodes.delete(phone);\n      return {\n        success: true,\n        message: 'Код подтвержден успешно!'\n      };\n    } else {\n      return {\n        success: false,\n        message: 'Неверный код. Попробуйте еще раз.'\n      };\n    }\n  }\n\n  /**\n   * Проверяет, есть ли активный код для телефона\n   */\n  public hasActiveCode(phone: string): boolean {\n    const storedData = this.generatedCodes.get(phone);\n    if (!storedData) return false;\n    \n    return Date.now() - storedData.timestamp <= this.CODE_EXPIRY_TIME;\n  }\n\n  /**\n   * Очищает все истекшие коды\n   */\n  public cleanupExpiredCodes(): void {\n    const now = Date.now();\n    this.generatedCodes.forEach((data, phone) => {\n      if (now - data.timestamp > this.CODE_EXPIRY_TIME) {\n        this.generatedCodes.delete(phone);\n      }\n    });\n  }\n\n  /**\n   * Получает количество активных кодов\n   */\n  public getActiveCodesCount(): number {\n    this.cleanupExpiredCodes();\n    return this.generatedCodes.size;\n  }\n\n  /**\n   * Получает код для тестирования (только для разработки)\n   */\n  public getCodeForTesting(phone: string): string | null {\n    const storedData = this.generatedCodes.get(phone);\n    if (storedData && Date.now() - storedData.timestamp <= this.CODE_EXPIRY_TIME) {\n      return storedData.code;\n    }\n    return null;\n  }\n}\n\n// Экспортируем экземпляр сервиса\nexport const verificationService = VerificationService.getInstance();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}